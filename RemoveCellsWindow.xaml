<Window x:Class="FilterV1.RemoveCellsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Remove Cell Pairs" Height="500" Width="500"
        WindowStartupLocation="CenterOwner">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Instructions -->
        <TextBlock Grid.Row="0" TextWrapping="Wrap" Margin="0,0,0,15" FontWeight="Bold">
            Define text patterns for removing rows. Rows where column 5 contains the first pattern 
            AND column 6 contains the second pattern will be removed.
        </TextBlock>

        <!-- Input Section -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBox x:Name="PasteTextBox" Width="350" Margin="0,0,10,0" 
                     Text="Paste cell pairs here..." 
                     GotFocus="TextBox_GotFocus" 
                     LostFocus="TextBox_LostFocus" 
                     PreviewKeyDown="PasteTextBox_PreviewKeyDown"
                     ToolTip="Paste pairs from Excel or enter manually. Format: FirstPattern[Tab]SecondPattern"/>
            <Button x:Name="AddButton" Click="AddButton_Click" Content="Add" Width="60"/>
        </StackPanel>

        <!-- DataGrid for Cell Pairs -->
        <DataGrid x:Name="CellPairsGrid" Grid.Row="2" Margin="0,0,0,10" 
                  AutoGenerateColumns="False" 
                  SelectionMode="Extended" 
                  CanUserAddRows="False" 
                  CanUserDeleteRows="False">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Column 5 Contains" Binding="{Binding FirstCell}" Width="*" IsReadOnly="True"/>
                <DataGridTextColumn Header="Column 6 Contains" Binding="{Binding SecondCell}" Width="*" IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Example Section -->
        <Grid Grid.Row="3" Margin="0,0,0,15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" Text="Example:" FontWeight="Bold" Margin="0,0,0,5"/>
            <TextBlock Grid.Row="1" TextWrapping="Wrap" FontStyle="Italic">
                Pattern "X2" + "K01" will remove rows where column 5 contains "X2" AND column 6 contains "K01"
            </TextBlock>
        </Grid>

        <!-- Button Section -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button x:Name="RemoveButton" Click="RemoveButton_Click" Content="Remove Selected" Width="120" Margin="0,0,10,0"/>
            <Button x:Name="ApplyButton" Click="ApplyButton_Click" Content="Apply" Width="80" Margin="0,0,10,0"/>
            <Button x:Name="CancelButton" Click="CancelButton_Click" Content="Cancel" Width="80"/>
        </StackPanel>
    </Grid>
</Window>